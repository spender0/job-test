# tasks file for ansible-rabbitmq
- include: debian.yml
  when: ansible_os_family == "Debian" and install == 'true'

- include: redhat.yml
  when: ansible_os_family == "RedHat" and install == 'true'
  
- name: checking to see if already clustered
  stat: path=/etc/rabbitmq/clustered
  register: clustered

- name: debug clustered
  debug: var=clustered

- name: debug enable_rabbitmq_clustering
  debug: var=enable_rabbitmq_clustering


- include: rabbitmq_clustering.yml
  when: enable_rabbitmq_clustering == 'true' and clustered.stat.exists != true

#- include: rabbitmq_ha_config.yml
#  when: config_rabbitmq_ha == 'true' and enable_rabbitmq_clustering == 'true'

- include: rabbitmq_users.yml
